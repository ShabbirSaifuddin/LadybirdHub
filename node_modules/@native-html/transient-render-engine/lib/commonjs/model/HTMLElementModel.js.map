{"version":3,"sources":["HTMLElementModel.ts"],"names":["phrasingCategories","translatableBlockCategories","HTMLElementModel","constructor","tagName","contentModel","isOpaque","mixedUAStyles","isVoid","getUADerivedStyleFromAttributes","getUADynamicMixedStyles","setMarkersForTNode","getDynamicReactNativeProps","reactNativeProps","fromCustomModel","customElementModel","optionalFields","fromNativeModel","nativeElementModel","category","otherProps","isPhrasing","indexOf","isTranslatable","HTMLContentModel","mixed","textual","block","none","isTranslatableBlock","isTranslatableTextual","extend","properties"],"mappings":"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","sourcesContent":["import { MixedStyleDeclaration } from '@native-html/css-processor';\nimport { ReactNativePropsDefinitions } from '../helper-types';\nimport { SetMarkersForTNode } from '../tree/tree-types';\nimport HTMLContentModel from './HTMLContentModel';\nimport {\n  CustomElementModel,\n  ElementCategory,\n  ElementModelBase,\n  NativeElementModel,\n  TagName\n} from './model-types';\n\nconst phrasingCategories: ElementCategory[] = ['textual', 'edits', 'anchor'];\nconst translatableBlockCategories: ElementCategory[] = [\n  'tabular',\n  'grouping',\n  'sectioning'\n];\n\n/**\n * An object to specify custom tags.\n *\n * @typeParam T - The name of the tag to which the model will apply.\n * @typeParam M - The {@link HTMLContentModel} associated with this tag.\n */\nexport interface HTMLElementModelProperties<\n  T extends string,\n  M extends HTMLContentModel\n> extends ElementModelBase<T> {\n  /**\n   * The {@link HTMLContentModel} attached to this model.\n   */\n  readonly contentModel: M;\n  /**\n   * `true` when the associated tag is a {@link https://html.spec.whatwg.org/multipage/syntax.html#void-elements | void element}.\n   *\n   * @remarks\n   *\n   * - Void elements cannot have children.\n   * - TText-translated void elements will be preserved even though they don't\n   *   have children.\n   */\n  readonly isVoid: boolean;\n}\n\n/**\n * An object defining engine internals for tags, such as default styles\n * (UAStyles), content model (how this tag is treated during hoisting)... etc.\n *\n * @typeParam T - The name of the tag to which the model will apply.\n * @typeParam M - The {@link HTMLContentModel} associated with this tag.\n */\nexport default class HTMLElementModel<\n  T extends string,\n  M extends HTMLContentModel\n> implements HTMLElementModelProperties<T, M>\n{\n  /**\n   * The tag name associated with this model.\n   */\n  public readonly tagName: T;\n  /**\n   * The {@link HTMLContentModel} attached to this model.\n   */\n  public readonly contentModel: M;\n  /**\n   * An opaque element translated {@link TNode} will have no translated {@link TNode}\n   * children.\n   */\n  public readonly isOpaque: boolean;\n  /**\n   * `true` when the associated tag is a {@link https://html.spec.whatwg.org/multipage/syntax.html#void-elements | void element}.\n   *\n   * @remarks\n   *\n   * - Void elements cannot have children.\n   * - TText-translated void elements will be preserved even though they don't\n   *   have children.\n   */\n  public readonly isVoid: boolean;\n  /**\n   * Equivalent of \"user-agent\" styles. The default styles for the element.\n   *\n   * @remarks These styles will be merged over by `tagsStyles`.\n   */\n  public readonly mixedUAStyles?: MixedStyleDeclaration;\n  /**\n   * React Native props to pass to renderers.\n   */\n  readonly reactNativeProps?: ReactNativePropsDefinitions;\n  /**\n   * A function to create conditional \"user-agent\" styles.\n   *\n   * @remarks For example, &lt;a&gt; tags will have underline decoration and be\n   * colored blue only when `href` is defined.\n   *\n   * @deprecated Use {@link HTMLElementModel.getUADynamicMixedStyles} instead.\n   */\n  public readonly getUADerivedStyleFromAttributes: NativeElementModel['getUADerivedStyleFromAttributes'];\n  /**\n   * A function to create conditional \"user-agent\" styles.\n   *\n   * @remarks For example, &lt;a&gt; tags will have underline decoration and be\n   * colored blue only when `href` is defined.\n   */\n  public readonly getUADynamicMixedStyles: NativeElementModel['getUADynamicMixedStyles'];\n\n  /**\n   * A function to pass conditional React Native props to renderers for a specific TNode.\n   */\n  public readonly getDynamicReactNativeProps: NativeElementModel['getDynamicReactNativeProps'];\n\n  /**\n   * Derive markers for one TNode.\n   */\n  public readonly setMarkersForTNode?: SetMarkersForTNode;\n\n  private constructor({\n    tagName,\n    contentModel,\n    isOpaque,\n    mixedUAStyles,\n    isVoid,\n    getUADerivedStyleFromAttributes,\n    getUADynamicMixedStyles,\n    setMarkersForTNode,\n    getDynamicReactNativeProps,\n    reactNativeProps\n  }: HTMLElementModelProperties<T, M>) {\n    this.tagName = tagName;\n    this.contentModel = contentModel;\n    this.isOpaque = isOpaque || false;\n    this.isVoid = isVoid;\n    this.mixedUAStyles = mixedUAStyles;\n    this.getUADerivedStyleFromAttributes = getUADerivedStyleFromAttributes;\n    this.getUADynamicMixedStyles = getUADynamicMixedStyles;\n    this.setMarkersForTNode = setMarkersForTNode;\n    this.getDynamicReactNativeProps = getDynamicReactNativeProps;\n    this.reactNativeProps = reactNativeProps;\n  }\n\n  /**\n   * Create an {@link HTMLElementModel} from a custom description.\n   *\n   * @param customElementModel - The custom model declaration.\n   */\n  static fromCustomModel<\n    CustomTags extends string,\n    ContentModel extends HTMLContentModel\n  >(\n    customElementModel: CustomElementModel<\n      Exclude<CustomTags, TagName>,\n      ContentModel\n    >\n  ) {\n    const {\n      contentModel,\n      tagName,\n      isOpaque = false,\n      isVoid = false,\n      ...optionalFields\n    } = customElementModel;\n    return new HTMLElementModel<Exclude<CustomTags, TagName>, ContentModel>({\n      tagName,\n      contentModel,\n      isOpaque,\n      isVoid,\n      ...optionalFields\n    });\n  }\n\n  /**\n   * Create an {@link HTMLElementModel} from a native description.\n   *\n   * @param nativeElementModel - The native model declaration.\n   */\n  static fromNativeModel<TN extends TagName, E extends ElementCategory>(\n    nativeElementModel: NativeElementModel<TN, E>\n  ) {\n    const {\n      category,\n      isOpaque,\n      isVoid = false,\n      ...otherProps\n    } = nativeElementModel;\n    const isPhrasing = phrasingCategories.indexOf(category) !== -1;\n    const isTranslatable =\n      isPhrasing || translatableBlockCategories.indexOf(category) !== -1;\n    const contentModel =\n      category === 'anchor' || category === 'edits'\n        ? HTMLContentModel.mixed\n        : isPhrasing\n        ? HTMLContentModel.textual\n        : isTranslatable\n        ? HTMLContentModel.block\n        : HTMLContentModel.none;\n    return new HTMLElementModel<\n      TN,\n      E extends 'edits' | 'anchor'\n        ? HTMLContentModel.mixed\n        : E extends 'sectioning' | 'grouping' | 'tabular'\n        ? HTMLContentModel.block\n        : E extends 'textual'\n        ? HTMLContentModel.textual\n        : HTMLContentModel.none\n    >({\n      isVoid,\n      contentModel: contentModel as any,\n      isOpaque: isOpaque ?? category === 'embedded',\n      ...otherProps\n    });\n  }\n\n  isTranslatableBlock(): boolean {\n    return this.contentModel === HTMLContentModel.block;\n  }\n\n  isTranslatableTextual() {\n    return (\n      this.contentModel === HTMLContentModel.textual ||\n      this.contentModel === HTMLContentModel.mixed\n    );\n  }\n\n  /**\n   * Create a new {@link HTMLElementModel} by merging properties into this model.\n   *\n   * @param properties - The {@link HTMLElementModelProperties} to merge into this model.\n   * @typeParam CM - The {@link HTMLContentModel} attached to the new model.\n   */\n  extend<CM extends HTMLContentModel>(\n    properties: Partial<HTMLElementModelProperties<T, CM>>\n  ): HTMLElementModel<T, CM> {\n    return new HTMLElementModel<T, CM>({\n      ...this,\n      ...properties\n    });\n  }\n}\n"]}