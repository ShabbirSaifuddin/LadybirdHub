{"version":3,"sources":["TNodeCtor.ts"],"names":["updateNodeIndexes","node","i","nodeIndex","emptyAttrs","Object","freeze","emptyClasses","setMarkersFromAttributes","targetMarkers","_parentMarkers","attributes","direction","dir","lang","transformPropsDefinitionsToSwitch","definition","text","all","view","prototype","children","init","classes","styles","TStyles","empty","markers","markersProtype","__nodeIndex","__trimmedLeft","__trimmedRight","__nativeProps","__generateNativeProps","elm","elementModel","getDynamicReactNativeProps","reactNativeProps","staticSwitchProps","derivedSwitch","domNode","attribs","hasWhiteSpaceCollapsingEnabled","webTextFlow","whiteSpace","contentModel","parentStyles","parent","id","tagName","name","isUnregistered","bindChildren","shouldUpdateNodeIndexes","forEach","cloneInitParams","partial","assign","isCollapsibleLeft","length","isCollapsibleRight","isEmpty","trimLeft","firstChild","splice","trimRight","lastChild","matchContentModel","spliceChildren","indexesToSplice","offset","collapse","collapseChildren","getNativeStyles","nativeBlockFlow","nativeBlockRet","nativeTextFlow","nativeTextRet","getWebStyles","webBlockRet","snapshot","options","withStyles","withNodeIndex","hasClass","className","indexOf","toString","setMarkers","parentMarkers","setMarkersForTNode","context","getReactNativeProps","initialize","class","split","extend","keys","stylesMerger","buildStyles","style","TNodeCtor","TNode","type","displayName","extraAccessors","defineProperties"],"mappings":"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","sourcesContent":["import {\n  ReactNativePropsSwitch,\n  ReactNativePropsDefinitions\n} from '../helper-types';\nimport { TStyles } from '../styles/TStyles';\nimport markersProtype from './markersProtype';\nimport tnodeToString from './tnodeSnapshot';\nimport {\n  Markers,\n  TNodeDescriptor,\n  TNodeImpl,\n  TNodeInit,\n  TNodeType\n} from './tree-types';\n\nexport type GenericTNodeCtor<Init = TNodeInit, Impl = TNodeImpl> = {\n  new (init: Init): Impl;\n  prototype: Impl;\n};\n\nexport type Mutable<T> = {\n  -readonly [P in keyof T]: T[P];\n};\n\nfunction updateNodeIndexes(node: Mutable<TNodeImpl>, i: number) {\n  node.nodeIndex = i;\n}\n\nconst emptyAttrs = Object.freeze({});\nconst emptyClasses = Object.freeze([]);\n\nfunction setMarkersFromAttributes(\n  targetMarkers: Markers,\n  _parentMarkers: Readonly<Markers>,\n  { attributes }: TNodeDescriptor\n): void {\n  if ('dir' in attributes) {\n    targetMarkers.direction = attributes.dir as 'rtl';\n  }\n  if ('lang' in attributes) {\n    targetMarkers.lang = attributes.lang;\n  }\n}\n\nfunction transformPropsDefinitionsToSwitch(\n  definition?: ReactNativePropsDefinitions | null\n): ReactNativePropsSwitch | null {\n  if (!definition) {\n    return null;\n  }\n  return {\n    text: {\n      ...definition.all,\n      ...definition.text\n    },\n    view: {\n      ...definition.all,\n      ...definition.view\n    }\n  };\n}\n\nconst prototype: Omit<TNodeImpl, 'displayName' | 'type'> = {\n  children: Object.freeze([]) as any,\n  init: Object.freeze({}) as any,\n  classes: Object.freeze([]) as any,\n  styles: Object.freeze(TStyles.empty()) as any,\n  markers: markersProtype,\n  __nodeIndex: null,\n  __trimmedLeft: false,\n  __trimmedRight: false,\n  __nativeProps: false,\n  __generateNativeProps() {\n    const elm = this.elementModel;\n    if (elm) {\n      if (!elm.getDynamicReactNativeProps && !elm.reactNativeProps) {\n        return null;\n      }\n      const staticSwitchProps = transformPropsDefinitionsToSwitch(\n        elm.reactNativeProps\n      );\n      if (!elm.getDynamicReactNativeProps) {\n        return staticSwitchProps;\n      }\n      const derivedSwitch = transformPropsDefinitionsToSwitch(\n        elm.getDynamicReactNativeProps(this as any) || null\n      );\n      if (staticSwitchProps && derivedSwitch) {\n        return {\n          view: {\n            ...staticSwitchProps.view,\n            ...derivedSwitch.view\n          },\n          text: {\n            ...staticSwitchProps.text,\n            ...derivedSwitch.text\n          }\n        };\n      }\n      return derivedSwitch;\n    }\n    return null;\n  },\n  get attributes() {\n    return this.domNode?.attribs || emptyAttrs;\n  },\n\n  get hasWhiteSpaceCollapsingEnabled() {\n    return typeof this.styles.webTextFlow.whiteSpace === 'string'\n      ? this.styles.webTextFlow.whiteSpace === 'normal'\n      : true;\n  },\n\n  get contentModel() {\n    return this.elementModel?.contentModel || null;\n  },\n\n  get parentStyles() {\n    return this.init.parentStyles || this.parent?.styles || null;\n  },\n\n  get id() {\n    return this.attributes.id || null;\n  },\n\n  get domNode() {\n    return this.init.domNode || null;\n  },\n\n  get elementModel() {\n    return this.init.elementModel;\n  },\n\n  get tagName() {\n    return this.init.domNode?.name || null;\n  },\n\n  get parent() {\n    return (this.init.parent as any) || null;\n  },\n\n  get nodeIndex() {\n    if (this.__nodeIndex === null) {\n      this.__nodeIndex = this.init.nodeIndex || 0;\n    }\n    return this.__nodeIndex;\n  },\n\n  get isUnregistered() {\n    return this.init.isUnregistered || false;\n  },\n\n  set nodeIndex(nodeIndex: number) {\n    this.__nodeIndex = nodeIndex;\n  },\n\n  bindChildren(children, shouldUpdateNodeIndexes = false) {\n    //@ts-ignore\n    this.children = children;\n    if (shouldUpdateNodeIndexes) {\n      children.forEach(updateNodeIndexes);\n    }\n  },\n\n  cloneInitParams(partial) {\n    return Object.assign({}, this.init, partial) as any;\n  },\n\n  isCollapsibleLeft() {\n    if (this.children.length) {\n      return (\n        this.hasWhiteSpaceCollapsingEnabled &&\n        this.children[0].isCollapsibleLeft()\n      );\n    }\n    return false;\n  },\n\n  isCollapsibleRight() {\n    if (this.children.length) {\n      return (\n        this.hasWhiteSpaceCollapsingEnabled &&\n        this.children[this.children.length - 1].isCollapsibleRight()\n      );\n    }\n    return false;\n  },\n\n  isEmpty() {\n    return false;\n  },\n\n  trimLeft() {\n    if (!this.__trimmedLeft && this.children.length) {\n      const firstChild = this.children[0];\n      firstChild.trimLeft();\n      if (firstChild.isEmpty()) {\n        //@ts-ignore\n        this.children.splice(0, 1);\n      }\n      this.__trimmedLeft = true;\n    }\n  },\n\n  trimRight() {\n    if (!this.__trimmedRight && this.children.length) {\n      const lastChild = this.children[this.children.length - 1];\n      lastChild.trimRight();\n      if (lastChild.isEmpty()) {\n        //@ts-ignore\n        this.children.splice(-1, 1);\n      }\n      this.__trimmedRight = true;\n    }\n  },\n\n  matchContentModel() {\n    return false;\n  },\n\n  spliceChildren(indexesToSplice) {\n    let offset = 0;\n    for (const i of indexesToSplice) {\n      //@ts-ignore\n      this.children.splice(i - offset, 1);\n      offset += 1;\n    }\n  },\n\n  collapse() {\n    this.collapseChildren();\n    this.bindChildren(this.children, true);\n  },\n\n  getNativeStyles() {\n    return {\n      ...this.styles.nativeBlockFlow,\n      ...this.styles.nativeBlockRet,\n      ...this.styles.nativeTextFlow,\n      ...this.styles.nativeTextRet\n    };\n  },\n\n  getWebStyles() {\n    return {\n      ...this.styles.webTextFlow,\n      ...this.styles.webBlockRet\n    } as any;\n  },\n\n  collapseChildren() {\n    return;\n  },\n\n  snapshot(options = {}) {\n    const { withStyles = false, withNodeIndex = false } = options;\n    return tnodeToString(this as any, { withStyles, withNodeIndex });\n  },\n\n  hasClass(className) {\n    return this.classes.indexOf(className) > -1;\n  },\n\n  toString() {\n    return this.snapshot();\n  },\n\n  setMarkers(targetMarkers, parentMarkers) {\n    if (this.elementModel?.setMarkersForTNode) {\n      this.elementModel.setMarkersForTNode(targetMarkers, parentMarkers, this);\n    }\n    setMarkersFromAttributes(targetMarkers, parentMarkers, this);\n    this.init.context.setMarkersForTNode?.(targetMarkers, parentMarkers, this);\n  },\n\n  getReactNativeProps() {\n    if (this.__nativeProps === false) {\n      this.__nativeProps = this.__generateNativeProps();\n    }\n    return this.__nativeProps;\n  },\n\n  initialize<Impl extends TNodeImpl<TNodeInit> = TNodeImpl>(\n    this: Mutable<Impl>,\n    init: Impl['init']\n  ) {\n    this.init = init;\n    this.classes = this.attributes.class?.split(/\\s+/) || emptyClasses;\n    const parentMarkers = init.parent\n      ? init.parent.markers\n      : markersProtype.extend();\n    this.markers = parentMarkers.extend();\n    this.setMarkers(this.markers, parentMarkers, this);\n    // Avoid very long prototype chains by assigning parent to current\n    // when current has no own properties\n    if (Object.keys(this.markers).length === 0) {\n      this.markers = parentMarkers;\n    }\n    this.styles =\n      init.styles ||\n      init.context.stylesMerger.buildStyles(\n        this.attributes.style,\n        this.parentStyles || null,\n        this\n      );\n  }\n};\n\nconst TNodeCtor = function TNode<Impl extends TNodeImpl = TNodeImpl>(\n  this: Mutable<TNodeImpl>,\n  type: TNodeType,\n  displayName: string,\n  extraAccessors?: {\n    [k in Exclude<keyof Impl, keyof TNodeImpl>]: {\n      get: () => any;\n      set?: (val: any) => void;\n    };\n  }\n) {\n  this.type = type;\n  this.displayName = displayName;\n  extraAccessors && Object.defineProperties(this, extraAccessors);\n};\n\nTNodeCtor.prototype = prototype as any;\n\nexport default TNodeCtor;\n"]}