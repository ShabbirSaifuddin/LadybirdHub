{"version":3,"sources":["useIMGNormalizedSource.ts"],"names":["useIMGNormalizedSource","source","concreteDimensions","cachedDimensions","provideEmbeddedHeaders","uri","headers","printWidth","current","width","printHeight","height"],"mappings":";;;;;;;AAAA;;AACA;;AAIe,SAASA,sBAAT,CAAgC;AAC7CC,EAAAA,MAD6C;AAE7CC,EAAAA;AAF6C,CAAhC,EAKZ;AACD,QAAMC,gBAAgB,GAAG,mBAAOD,kBAAP,CAAzB;AACA,QAAM;AAAEE,IAAAA;AAAF,MAA6B,0CAAnC;AACA,SAAO,oBAAQ,MAAM;AACnB,QAAIH,MAAM,CAACI,GAAP,IAAc,OAAOD,sBAAP,KAAkC,UAApD,EAAgE;AAAA;;AAC9D,YAAME,OAAO,GAAGF,sBAAsB,CAACH,MAAM,CAACI,GAAR,EAAa,KAAb,EAAoB;AACxDE,QAAAA,UAAU,2BAAEJ,gBAAgB,CAACK,OAAnB,0DAAE,sBAA0BC,KADkB;AAExDC,QAAAA,WAAW,4BAAEP,gBAAgB,CAACK,OAAnB,2DAAE,uBAA0BG;AAFiB,OAApB,CAAtC;;AAIA,UAAIL,OAAJ,EAAa;AACX,eAAO;AACLA,UAAAA,OADK;AAEL,aAAGL;AAFE,SAAP;AAID;AACF;;AACD,WAAOA,MAAP;AACD,GAdM,EAcJ,CAACG,sBAAD,EAAyBH,MAAzB,CAdI,CAAP;AAeD","sourcesContent":["import { useMemo, useRef } from 'react';\nimport { useSharedProps } from '../context/SharedPropsProvider';\nimport { ImageDimensions } from '../shared-types';\nimport { UseIMGElementStateProps } from './img-types';\n\nexport default function useIMGNormalizedSource({\n  source,\n  concreteDimensions\n}: Pick<UseIMGElementStateProps, 'source'> & {\n  concreteDimensions: ImageDimensions | null;\n}) {\n  const cachedDimensions = useRef(concreteDimensions);\n  const { provideEmbeddedHeaders } = useSharedProps();\n  return useMemo(() => {\n    if (source.uri && typeof provideEmbeddedHeaders === 'function') {\n      const headers = provideEmbeddedHeaders(source.uri, 'img', {\n        printWidth: cachedDimensions.current?.width,\n        printHeight: cachedDimensions.current?.height\n      });\n      if (headers) {\n        return {\n          headers,\n          ...source\n        };\n      }\n    }\n    return source;\n  }, [provideEmbeddedHeaders, source]);\n}\n"]}